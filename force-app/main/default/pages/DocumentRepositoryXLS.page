<apex:page
  controller="DocumentCtrl"
  action="{!getListWithAtts}"
  showHeader="false"
  sidebar="false"
  readOnly="true"
  contentType="application/vnd.ms-excel#DocumentReport.xls"
>
  <h4>{!reportTitle}</h4>
  <table>
    <tr>
      <th>Agency name</th>
      <th>Agency ID</th>
      <th>Document Location</th>
      <th>File Name</th>
      <th>Status</th>
      <th>Document Name</th>
      <th>Document Due Date</th>
      <th>Access mode</th>
    </tr>
    <apex:repeat value="{!doc_list}" var="i">
      <tr>
        <td>{!i.Organization_Name__c}</td>
        <td>{!i.Organization_Id__c}</td>
        <td>
          {!IF(i.Object_Type__c == 'Grant', i.Parent_Name__c, 'All Grant
          Compliance')}
        </td>
        <td>
          <apex:repeat value="{!i.Attachments}" var="a">
            {!a.Name}
          </apex:repeat>
        </td>
        <td>{!i.Status__c}</td>
        <td>{!i.Name}</td>
        <td>
          <apex:outputText value="{0, date, MMMM d','  yyyy}">
            <apex:param value="{!i.Due_Date__c}" />
          </apex:outputText>
        </td>
        <td>{!i.Access_Mode__c}</td>
      </tr>
    </apex:repeat>
  </table>
</apex:page>
